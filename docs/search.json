[
  {
    "objectID": "modelo_LightGBM.html",
    "href": "modelo_LightGBM.html",
    "title": "Análisis Predictivo: Desistimiento de Clientes",
    "section": "",
    "text": "import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split, RandomizedSearchCV\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.metrics import classification_report, confusion_matrix, precision_recall_curve\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.impute import SimpleImputer\nimport lightgbm as lgb\nimport joblib\nimport plotly.express as px\nimport plotly.io as pio\nimport plotly.express as px\npio.renderers.default = \"notebook_connected\"\nimport warnings\nwarnings.filterwarnings(\"ignore\", category=FutureWarning)\nsns.set_style(\"whitegrid\")\n\n\n#cargar datos\n\ndf = pd.read_excel(\"Data_bancaria.xlsx\")\n\n\n# EDA\n\ndf.head()\n\n\n\n\n\n\n\n\nSOLICITUD\nFECHA_INICIO\nMULTAS_SIMIT\nEDAD\nCUOTA_INICIAL\nGENERO\nESTADO_CIVIL\nNIVEL_ESTUDIO\nTIPO_VIVIENDA\nPERSONAS_CARGO\n...\nTIPO_CLIENTE\nHABITO_PAGO\nENDEUDAMIENTO\nCALIFICACION\nCREDITOS_VIGENTES\nPuntaje Riesgo\nTIPO_CONTRATO\nANTIGUEDAD\nMarca producto\nEstado\n\n\n\n\n0\n1\n2017-01-02\n0.0\n29\n0\nF\nDivorciado\nTecnólogico\nArrendada\n2\n...\nIndependiente sin Establecimiento\nB\n85860.0\nA\n2\n2190\nIndefinido\n10\nMarca A\nAprobada\n\n\n1\n2\n2017-01-02\n0.0\n60\n1035000\nF\nSoltero\nTecnólogico\nArrendada\n1\n...\nIndependiente sin Establecimiento\nE\n1270940.0\nC\n9\n2142\nPor Obra o Labor\n131\nMarca A\nDesistida\n\n\n2\n3\n2017-01-02\n0.0\n61\n472500\nM\nDivorciado\nTecnólogico\nArrendada\n1\n...\nIndependiente sin Establecimiento\nE\n664620.0\nC\n7\n2073\nIndefinido\n63\nMarca B\nAnulada\n\n\n3\n4\n2017-01-02\n0.0\n25\n0\nM\nCasado\nTecnólogico\nArrendada\n2\n...\nIndependiente sin Establecimiento\nB\n51940.0\nA\n2\n1929\nOtra\n12\nMarca A\nNegada\n\n\n4\n5\n2017-01-02\n0.0\n30\n3672000\nF\nDivorciado\nTecnólogico\nArrendada\n3\n...\nIndependiente sin Establecimiento\nB\n0.0\nA\n2\n3\nINDEPENDIENTE SIN ESTABLECIMIENTO\n131\nMarca A\nAnulada\n\n\n\n\n5 rows × 27 columns\n\n\n\n\ndf.tail()\n\n\n\n\n\n\n\n\nSOLICITUD\nFECHA_INICIO\nMULTAS_SIMIT\nEDAD\nCUOTA_INICIAL\nGENERO\nESTADO_CIVIL\nNIVEL_ESTUDIO\nTIPO_VIVIENDA\nPERSONAS_CARGO\n...\nTIPO_CLIENTE\nHABITO_PAGO\nENDEUDAMIENTO\nCALIFICACION\nCREDITOS_VIGENTES\nPuntaje Riesgo\nTIPO_CONTRATO\nANTIGUEDAD\nMarca producto\nEstado\n\n\n\n\n33663\n33664\n2017-12-04\n466798.20\n40\n900000\nF\nCasado\nTecnólogico\nArrendada\n2\n...\nIndependiente sin Establecimiento\nE\n270300.0\nC\n5\n2205\nOtra\n5\nMarca A\nDesistida\n\n\n33664\n33665\n2017-11-16\n1522346.78\n39\n692910\nF\nDivorciado\nTecnólogico\nArrendada\n3\n...\nIndependiente sin Establecimiento\nB\n0.0\nA\n1\n3\nIndefinido\n8\nMarca A\nDesistida\n\n\n33665\n33666\n2017-11-21\n0.00\n25\n1296000\nF\nCasado\nTecnólogico\nArrendada\n1\n...\nIndependiente sin Establecimiento\nE\n115540.0\nA\n3\n1041\nLibre Nombramiento\n28\nMarca A\nAprobada\n\n\n33666\n33667\n2017-12-06\n0.00\n27\n1116000\nF\nCasado\nTecnólogico\nPropia sin hipoteca\n3\n...\nIndependiente sin Establecimiento\nE\n392200.0\nC\n5\n2232\nPor Obra o Labor\n55\nMarca A\nAprobada\n\n\n33667\n33668\n2017-12-11\n0.00\n23\n324000\nF\nDivorciado\nPostgrado\nPropia sin hipoteca\n1\n...\nIndependiente sin Establecimiento\nB\n0.0\nA\n0\n21\nPor Obra o Labor\n24\nMarca A\nDesistida\n\n\n\n\n5 rows × 27 columns\n\n\n\n\ndf.describe()\n\n\n\n\n\n\n\n\nSOLICITUD\nFECHA_INICIO\nMULTAS_SIMIT\nEDAD\nCUOTA_INICIAL\nPERSONAS_CARGO\nPLAZO\nVALOR_SOLICITADO\nINGRESOS\nEGRESOS\nENDEUDAMIENTO\nCREDITOS_VIGENTES\nPuntaje Riesgo\nANTIGUEDAD\n\n\n\n\ncount\n33668.000000\n33668\n3.366800e+04\n33668.000000\n3.366800e+04\n33668.000000\n33668.000000\n3.366800e+04\n3.366800e+04\n3.366800e+04\n3.366800e+04\n33668.000000\n33668.000000\n33668.000000\n\n\nmean\n16834.500000\n2017-06-03 21:53:52.172983296\n7.647234e+04\n34.103956\n6.283836e+05\n2.042028\n36.404360\n4.833895e+06\n1.768666e+06\n7.119266e+05\n3.764307e+05\n2.421944\n1379.838897\n39.079066\n\n\nmin\n1.000000\n2017-01-02 00:00:00\n0.000000e+00\n-1.000000\n0.000000e+00\n1.000000\n6.000000\n5.250000e+05\n0.000000e+00\n0.000000e+00\n-2.554600e+05\n0.000000\n0.000000\n0.000000\n\n\n25%\n8417.750000\n2017-04-06 00:00:00\n0.000000e+00\n26.000000\n1.305000e+05\n1.000000\n36.000000\n3.726450e+06\n1.041600e+06\n3.390000e+05\n0.000000e+00\n1.000000\n21.000000\n8.000000\n\n\n50%\n16834.500000\n2017-06-10 00:00:00\n0.000000e+00\n31.000000\n4.278240e+05\n2.000000\n36.000000\n4.608450e+06\n1.344000e+06\n5.650000e+05\n1.049400e+05\n2.000000\n1803.000000\n19.000000\n\n\n75%\n25251.250000\n2017-07-31 00:00:00\n0.000000e+00\n39.000000\n7.380000e+05\n3.000000\n36.000000\n5.782875e+06\n1.792000e+06\n7.684000e+05\n3.498000e+05\n3.000000\n2139.000000\n43.000000\n\n\nmax\n33668.000000\n2017-12-31 00:00:00\n6.679191e+06\n2000.000000\n9.900000e+06\n29.000000\n60.000000\n1.363950e+07\n1.563520e+08\n8.554100e+07\n1.425000e+08\n89.000000\n2742.000000\n637.000000\n\n\nstd\n9719.258768\nNaN\n3.007114e+05\n16.251590\n7.663405e+05\n1.010997\n8.509071\n1.473938e+06\n2.215846e+06\n1.360024e+06\n1.624263e+06\n2.571922\n907.210098\n55.645814\n\n\n\n\n\n\n\n\ndf.info()\n\n&lt;class 'pandas.core.frame.DataFrame'&gt;\nRangeIndex: 33668 entries, 0 to 33667\nData columns (total 27 columns):\n #   Column             Non-Null Count  Dtype         \n---  ------             --------------  -----         \n 0   SOLICITUD          33668 non-null  int64         \n 1   FECHA_INICIO       33668 non-null  datetime64[ns]\n 2   MULTAS_SIMIT       33668 non-null  float64       \n 3   EDAD               33668 non-null  int64         \n 4   CUOTA_INICIAL      33668 non-null  int64         \n 5   GENERO             33668 non-null  object        \n 6   ESTADO_CIVIL       33668 non-null  object        \n 7   NIVEL_ESTUDIO      33668 non-null  object        \n 8   TIPO_VIVIENDA      33668 non-null  object        \n 9   PERSONAS_CARGO     33668 non-null  int64         \n 10  ZONA               33668 non-null  object        \n 11  PLAZO              33668 non-null  int64         \n 12  CODEUDOR           33668 non-null  object        \n 13  VALOR_SOLICITADO   33668 non-null  float64       \n 14  INGRESOS           33668 non-null  float64       \n 15  EGRESOS            33668 non-null  float64       \n 16  SUBTIPO_CLIENTE    33668 non-null  object        \n 17  TIPO_CLIENTE       33668 non-null  object        \n 18  HABITO_PAGO        33668 non-null  object        \n 19  ENDEUDAMIENTO      33668 non-null  float64       \n 20  CALIFICACION       33668 non-null  object        \n 21  CREDITOS_VIGENTES  33668 non-null  int64         \n 22  Puntaje Riesgo     33668 non-null  int64         \n 23  TIPO_CONTRATO      33291 non-null  object        \n 24  ANTIGUEDAD         33668 non-null  int64         \n 25  Marca producto     33668 non-null  object        \n 26  Estado             33668 non-null  object        \ndtypes: datetime64[ns](1), float64(5), int64(8), object(13)\nmemory usage: 6.9+ MB\n\n\n\ndf.duplicated().sum()\n\nnp.int64(0)\n\n\n\ndf.isna().sum()\n\nSOLICITUD              0\nFECHA_INICIO           0\nMULTAS_SIMIT           0\nEDAD                   0\nCUOTA_INICIAL          0\nGENERO                 0\nESTADO_CIVIL           0\nNIVEL_ESTUDIO          0\nTIPO_VIVIENDA          0\nPERSONAS_CARGO         0\nZONA                   0\nPLAZO                  0\nCODEUDOR               0\nVALOR_SOLICITADO       0\nINGRESOS               0\nEGRESOS                0\nSUBTIPO_CLIENTE        0\nTIPO_CLIENTE           0\nHABITO_PAGO            0\nENDEUDAMIENTO          0\nCALIFICACION           0\nCREDITOS_VIGENTES      0\nPuntaje Riesgo         0\nTIPO_CONTRATO        377\nANTIGUEDAD             0\nMarca producto         0\nEstado                 0\ndtype: int64\n\n\n\ndf[\"TIPO_CONTRATO\"].unique()\n\narray(['Indefinido', 'Por Obra o Labor', 'Otra',\n       'INDEPENDIENTE SIN ESTABLECIMIENTO',\n       'INDEPENDIENTE CON ESTABLECIMIENTO', 'Temporal',\n       'Libre Nombramiento', 'Carrera Administrati', 'Provisionalidad',\n       'Propiedad', 'Término Fijo', nan], dtype=object)\n\n\n\ndf[\"TIPO_CONTRATO\"] = df[\"TIPO_CONTRATO\"].fillna(\"Otra\")\n\n\ndf.isna().sum()\n\nSOLICITUD            0\nFECHA_INICIO         0\nMULTAS_SIMIT         0\nEDAD                 0\nCUOTA_INICIAL        0\nGENERO               0\nESTADO_CIVIL         0\nNIVEL_ESTUDIO        0\nTIPO_VIVIENDA        0\nPERSONAS_CARGO       0\nZONA                 0\nPLAZO                0\nCODEUDOR             0\nVALOR_SOLICITADO     0\nINGRESOS             0\nEGRESOS              0\nSUBTIPO_CLIENTE      0\nTIPO_CLIENTE         0\nHABITO_PAGO          0\nENDEUDAMIENTO        0\nCALIFICACION         0\nCREDITOS_VIGENTES    0\nPuntaje Riesgo       0\nTIPO_CONTRATO        0\nANTIGUEDAD           0\nMarca producto       0\nEstado               0\ndtype: int64\n\n\n\ndf[\"Estado\"].unique()\n\narray(['Aprobada', 'Desistida', 'Anulada', 'Negada'], dtype=object)\n\n\n\nestados_finales = [\"Desistida\", \"Negada\", \"Aprobada\",\"Anulada\"]\ndf = df[df[\"Estado\"].isin(estados_finales)].copy()\n\n\ncounts = df[\"Estado\"].map({\n    \"Desistida\": \"Desiste\", \n    \"Aprobada\": \"No Desiste\", \n    \"Negada\": \"No Desiste\", \n    \"Anulada\": \"No Desiste\"\n}).value_counts().reset_index()\n\ncounts.columns = ['Estado', 'Cantidad']\n\nfig_balance = px.bar(counts, x='Estado', y='Cantidad', \n             title=\"Balance de la Variable Objetivo\",\n             color='Estado',\n             color_discrete_map={'Desiste': '#EF553B', 'No Desiste': '#636EFA'},\n             template=\"plotly_white\")\n\nfig_balance.show()\n\n                            \n                                            \n\n\n\nfig_estados = px.histogram(\n    df, \n    x=\"Estado\", \n    title=\"&lt;b&gt;Distribución de Estados Finales&lt;/b&gt;\",\n    color=\"Estado\",  \n    color_discrete_sequence=px.colors.sequential.Viridis,\n    template=\"plotly_white\"\n)\n\n\nfig_estados.update_layout(\n    xaxis_title=\"Estado de la Solicitud\",\n    yaxis_title=\"Cantidad de Clientes\",\n    xaxis={'categoryorder':'total descending'}, \n    showlegend=False\n)\n\nfig_estados.show()\n\n                            \n                                            \n\n\n\ncolumnas_quitar = [\"SOLICITUD\", \"FECHA_INICIO\", \"GENERO\", \"Marca producto\"]\ndf.drop(columns=columnas_quitar, inplace=True)\n\n\n# 1 = Desiste 0 = No desiste \ndf[\"DESISTE\"] = (df[\"Estado\"] == \"Desistida\").astype(int)\ndf = df.drop(columns=[\"Estado\"])\n\n\n# Ingenieria de caracteristicas\n\ndf[\"CAPACIDAD_PAGO\"] = df[\"INGRESOS\"] - df[\"EGRESOS\"]\n\ndf[\"RATIO_ENDEUDAMIENTO\"] = df[\"EGRESOS\"] / (df[\"INGRESOS\"] + 1e-6)\n\ndf[\"RATIO_SOLICITUD_INGRESO\"] = df[\"VALOR_SOLICITADO\"] / (df[\"INGRESOS\"] + 1e-6)\n\ndf[\"ESTRES_FINANCIERO\"] = df[\"RATIO_ENDEUDAMIENTO\"] + df[\"RATIO_SOLICITUD_INGRESO\"]\n\n\n\n#procesamiento previo\n\nfrom sklearn.compose import ColumnTransformer, make_column_selector\n\n\nX = df.drop(columns=[\"DESISTE\"])\ny = df[\"DESISTE\"]\n\nX_temp, X_test, y_temp, y_test = train_test_split(\n    X, y,\n    test_size=0.2,\n    random_state=42,\n    stratify=y\n)\n\nX_train, X_val, y_train, y_val = train_test_split(\n    X_temp, y_temp,\n    test_size=0.2,\n    random_state=42,\n    stratify=y_temp\n)\n\nnumeric_transformer = Pipeline(steps=[\n    (\"imputer\", SimpleImputer(strategy=\"median\"))\n])\n\ncategorical_transformer = Pipeline(steps=[\n    (\"imputer\", SimpleImputer(strategy=\"constant\", fill_value=\"Desconocido\")),\n    (\"onehot\", OneHotEncoder(handle_unknown=\"ignore\", sparse_output=False))\n])\n\npreprocessor = ColumnTransformer(\n    transformers=[\n        (\"num\", numeric_transformer, make_column_selector(dtype_exclude=\"object\")),\n        (\"cat\", categorical_transformer, make_column_selector(dtype_include=\"object\")),\n    ]\n)\n\n\n\n\n# Calcular el peso para la clase minoritaria (1 = Desiste)\ncount_class_0 = y_train.value_counts()[0]\ncount_class_1 = y_train.value_counts()[1]\nscale_pos_weight = count_class_0 / count_class_1\n\nprint(f\"Peso aplicado a la clase 1 (Desiste): {scale_pos_weight:.2f}\")\n\nlgbm = lgb.LGBMClassifier(\n    objective=\"binary\",\n    metric=\"binary_logloss\",\n    random_state=42,\n    n_jobs=-1,\n    scale_pos_weight=scale_pos_weight\n)\n\nclf_pipeline_lgbm = Pipeline(steps=[\n    (\"preprocessor\", preprocessor),\n    (\"classifier\", lgbm)\n])\n\nparam_dist_lgbm = {\n    \"classifier__n_estimators\": [300, 500, 800],\n    \"classifier__learning_rate\": [0.01, 0.03, 0.1],\n    \"classifier__num_leaves\": [20, 31, 50],\n    \"classifier__max_depth\": [-1, 7, 10],\n    \"classifier__subsample\": [0.7, 0.9, 1.0],\n    \"classifier__colsample_bytree\": [0.7, 0.9, 1.0],\n    \"classifier__min_child_samples\": [20, 50, 100],\n    \"classifier__reg_lambda\": [0, 1, 5]\n}\n\nprint(\"Entrenando y buscando mejores parámetros de LightGBM...\")\nrandom_search_lgbm = RandomizedSearchCV(\n    clf_pipeline_lgbm,\n    param_distributions=param_dist_lgbm,\n    n_iter=30,         \n    cv=5,\n    scoring=\"f1\",      \n    n_jobs=-1,\n    random_state=42,\n    verbose=1\n)\n\nrandom_search_lgbm.fit(X_train, y_train)\n\nbest_model_lgbm = random_search_lgbm.best_estimator_\nprint(f\"Mejores parámetros LightGBM: {random_search_lgbm.best_params_}\")\n\nPeso aplicado a la clase 1 (Desiste): 1.74\nEntrenando y buscando mejores parámetros de LightGBM...\nFitting 5 folds for each of 30 candidates, totalling 150 fits\n[LightGBM] [Info] Number of positive: 7850, number of negative: 13697\n[LightGBM] [Info] Auto-choosing row-wise multi-threading, the overhead of testing was 0.001130 seconds.\nYou can set `force_row_wise=true` to remove the overhead.\nAnd if memory is not enough, you can set `force_col_wise=true`.\n[LightGBM] [Info] Total Bins 3277\n[LightGBM] [Info] Number of data points in the train set: 21547, number of used features: 73\n[LightGBM] [Info] [binary:BoostFromScore]: pavg=0.364320 -&gt; initscore=-0.556663\n[LightGBM] [Info] Start training from score -0.556663\nMejores parámetros LightGBM: {'classifier__subsample': 0.9, 'classifier__reg_lambda': 1, 'classifier__num_leaves': 31, 'classifier__n_estimators': 500, 'classifier__min_child_samples': 20, 'classifier__max_depth': -1, 'classifier__learning_rate': 0.03, 'classifier__colsample_bytree': 0.7}\n\n\n\n\n\n# Ajustar umbral \ny_proba_val = best_model_lgbm.predict_proba(X_val)[:, 1]\n\nprecisions, recalls, thresholds = precision_recall_curve(y_val, y_proba_val)\nf1_scores = np.nan_to_num(2 * (precisions * recalls) / (precisions + recalls))\nbest_threshold_idx = np.argmax(f1_scores)\nbest_threshold_lgbm = thresholds[best_threshold_idx]\n\nprint(f\"\\n--- 6. Umbral Óptimo LightGBM (validación) encontrado: {best_threshold_lgbm:.4f} ---\")\nprint(f\"Precision @umbral_opt: {precisions[best_threshold_idx]:.4f}\")\nprint(f\"Recall    @umbral_opt: {recalls[best_threshold_idx]:.4f}\")\nprint(f\"F1        @umbral_opt: {f1_scores[best_threshold_idx]:.4f}\")\n\n\n--- 6. Umbral Óptimo LightGBM (validación) encontrado: 0.4107 ---\nPrecision @umbral_opt: 0.4786\nRecall    @umbral_opt: 0.7406\nF1        @umbral_opt: 0.5814\n\n\n\n\n#  Evaluar \n\ny_proba_test = best_model_lgbm.predict_proba(X_test)[:, 1]\ny_pred_test_opt = (y_proba_test &gt;= best_threshold_lgbm).astype(int)\n\nprint(classification_report(y_test, y_pred_test_opt))\n\n              precision    recall  f1-score   support\n\n           0       0.78      0.54      0.64      4281\n           1       0.48      0.74      0.58      2453\n\n    accuracy                           0.61      6734\n   macro avg       0.63      0.64      0.61      6734\nweighted avg       0.67      0.61      0.62      6734\n\n\n\n\nimport plotly.figure_factory as ff\nfrom sklearn.metrics import confusion_matrix\n\ncm = confusion_matrix(y_test, y_pred_test_opt)\n\nx_labels = [\"Predicho: No Desiste\", \"Predicho: Desiste\"]\ny_labels = [\"Real: No Desiste\", \"Real: Desiste\"]\n\n\nz = cm[::-1] \ny_labels_adj = y_labels[::-1]\n\nz_text = [\n    [f\"Clientes Perdidos (FN): {z[0][0]}\", f\"Clientes Salvados (VP): {z[0][1]}\"],\n    [f\"Correctos (VN): {z[1][0]}\", f\"Falsas Alarmas (FP): {z[1][1]}\"]\n]\n\nfig_cm = ff.create_annotated_heatmap(\n    z, \n    x=x_labels, \n    y=y_labels_adj, \n    annotation_text=z, \n    colorscale='Greens'\n)\n\nfig_cm.update_layout(\n    title_text=f'&lt;b&gt;Impacto del Modelo LightGBM (Umbral: {best_threshold_lgbm:.2f})&lt;/b&gt;',\n    xaxis_title=\"Predicción del Modelo\",\n    yaxis_title=\"Realidad del Cliente\",\n    width=600,\n    height=500,\n    template=\"plotly_white\"\n)\n\nfig_cm.show()\n\n                            \n                                            \n\n\n\nnum_cols = X.select_dtypes(exclude=\"object\").columns\ncat_cols = X.select_dtypes(include=\"object\").columns\n\n\n\n# Nombres de columnas \nfeature_names_num = num_cols.tolist()\n\nohe = best_model_lgbm.named_steps[\"preprocessor\"].named_transformers_[\"cat\"].named_steps[\"onehot\"]\nfeature_names_cat = ohe.get_feature_names_out(cat_cols)\n\nall_feature_names = np.r_[feature_names_num, feature_names_cat]\n\nimportances = best_model_lgbm.named_steps[\"classifier\"].feature_importances_\nfeature_imp = pd.Series(importances, index=all_feature_names).sort_values(ascending=False).head(15)\n\ndf_imp = feature_imp.reset_index()\ndf_imp.columns = ['Variable', 'Importancia']\n\n\nfig_imp = px.bar(df_imp, \n                 x='Importancia', \n                 y='Variable', \n                 orientation='h',\n                 title=\"Top 15 Variables Predictoras (LightGBM)\",\n                 color='Importancia',\n                 color_continuous_scale='Greens',\n                 template=\"plotly_white\")\n\nfig_imp.update_layout(yaxis={'categoryorder':'total ascending'}) # Ordenar de mayor a menor\nfig_imp.show()\n\n                            \n                                            \n\n\n\nimport shap\n\n\nlgbm_model = best_model_lgbm.named_steps[\"classifier\"]\npreprocessor = best_model_lgbm.named_steps[\"preprocessor\"]\n\nX_test_sample = X_test.sample(min(1000, len(X_test)), random_state=42)\nX_transformed = preprocessor.transform(X_test_sample)\n\nexplainer = shap.TreeExplainer(lgbm_model)\nshap_values = explainer.shap_values(X_transformed)\n\nif isinstance(shap_values, list):\n    shap_to_plot = shap_values[1]\nelse:\n    shap_to_plot = shap_values\n\nshap.summary_plot(shap_to_plot, X_transformed, feature_names=all_feature_names)\n\n\n\n\n\n\n\n\n\nmodelo = best_model_lgbm\nbest_threshold = best_threshold_lgbm\n\nartifact = {\n    \"modelo\": modelo,\n    \"best_threshold\": best_threshold,\n    \"feature_cols\": X.columns.tolist(),\n}\n\njoblib.dump(artifact, \"modelo_desistimiento_lgbm.joblib\")\nprint(\"Modelo guardado en 'modelo_desistimiento_lgbm.joblib'\")\n\nModelo guardado en 'modelo_desistimiento_lgbm.joblib'"
  }
]